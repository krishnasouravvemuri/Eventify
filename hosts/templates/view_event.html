{% extends "layout.html" %}

{% block title %}Eventify | View Events{% endblock  %}

{% block header %}
<a href="{% url 'logout_user' %}" class="bg-red-600 p-3 font-semibold rounded hover:bg-red-800 transition-colors duration-300">Logout</a>
{% endblock %}

{% block eventify %}
<a href="{% url 'hosts_home' %}">EVENTIFY</a>
{% endblock %}

{% block body %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-2xl font-bold mb-6 text-center">My Events</h1>

    <div class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for event in events %}
        <div class="text-white rounded-lg border shadow-lg overflow-hidden duration-300 transform transition-transform hover:scale-105 hover:shadow-2xl">
            {% if event.banner %}
            <img src="{{ event.banner.url }}" alt="{{ event.name }}" class="w-full h-40 object-cover transition-opacity duration-500 ease-in-out hover:opacity-90">
            {% endif %}

            <div class="p-4">
                <h2 class="text-xl font-semibold text-indigo-500">{{ event.name }}</h2>
                <p><strong>Place :</strong> {{ event.place }}</p>
                <p><strong>Date :</strong> {{ event.date }}</p>
                <p><strong>Time :</strong> {{ event.time }}</p>
                <p><strong>Seats Left :</strong> {{ event.remaining_seats }} / {{ event.seats }}</p>

                <div class="flex gap-3 mt-3.5">
                    <a href="{% url 'edit_event' event.id %}" class="bg-indigo-700 px-4 py-2 rounded hover:bg-indigo-900 transition-colors duration-300">Edit Event</a>
                    <button onclick="openDeleteModal({{ event.id }})" class="bg-red-600 px-4 py-2 rounded hover:bg-red-700 transition-colors duration-300">Delete</button>
                </div>
            </div>
        </div>
        {% empty %}
        <p class="col-span-full text-center text-gray-500">No events found.</p>
        {% endfor %}
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="fixed hidden inset-0  z-50  items-center justify-center">
    <div class="absolute inset-0 bg-white/20 backdrop-blur-md"></div>
    <div class="relative bg-slate-900 rounded-2xl shadow-2xl w-96 p-6 text-center mx-4">
        <h2 class="text-2xl font-bold mb-2 text-white">Confirm Delete?</h2>
        <p class="text-white/80 mb-6 text-sm">Are you sure you want to delete this event? This action cannot be undone.</p>
        <div class="flex justify-center gap-4">
            <form id="deleteForm" method="POST">
                {% csrf_token %}
                <button type="submit" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-xl font-semibold transition">Yes</button>
            </form>
            <button onclick="closeModal('deleteModal')" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-xl font-semibold cursor-pointer transition">Cancel</button>
        </div>
    </div>
</div>

<script>
function openDeleteModal(eventId) {
    const modal = document.getElementById('deleteModal');
    const form = document.getElementById('deleteForm');
    form.action = `/hosts/delete_event/${eventId}/`; 
    modal.classList.remove('hidden');
}
function closeModal(id) {
    document.getElementById(id).classList.add('hidden');
}
</script>

{% endblock %}
